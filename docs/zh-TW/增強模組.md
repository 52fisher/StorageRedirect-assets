### 增強模組

增強模組包括以下功能：

* 開機時保證 _儲存重新導向_  早於普通應用啟動
* 保證重新導向一定會在被重新導向的應用本身的邏輯之前執行
* 監控公共儲存空間檔案訪問

#### 注意事項

* **必須配合 _儲存重新導向_ 0.15.0 版本或以上使用**
* **出現任何問題，請嘗試停用（刪除）模組**
* 如果出現問題，提供開機以來的 log 給開發者會很有幫助*
* （Magisk 模組方式）安裝前**請務必確認已經瞭解如何在無法進入系統時刪除模組**，否則如果系統與其不相容，將會無法進入系統
* （Magisk 模組方式）需要刪除任何舊的模組
* （Magisk 模組方式）需要 Magisk v15+

#### 已知問題

* 如果使用 Xposed 可能會無效
* _軟重啟_（非正常重啟）會導致 MTP，adb 甚至全部程式無法讀取儲存空間，**此時正常重啟即可**

#### 下載

**請確定已閱讀說明，否則如果出現已經提到的情況，開發者會責怪你**

_由於該方案需要替換系統檔案，我們暫時只提供 Magisk 模組。_

[Magisk 模組 v12 for arm](https://github.com/RikkaApps/StorageRedirect-assets/releases/download/assets/magisk-sr-native-inject-arm-v12.zip)

[Magisk 模組 v12 for arm64](https://github.com/RikkaApps/StorageRedirect-assets/releases/download/assets/magisk-sr-native-inject-arm64-v12.zip)

#### 如何確認已經起作用

* 開機過程中，觀察有沒有 `StorageRedirectInject: replaced com.android.internal.os.Zygote#nativeForkAndSpecialize` 的 log（由於會在非常早期的啟動過程中被觸發，必須連接電腦使用 adb 才可能看到）
* 當開啟任意程式時，觀察是否有如 `StorageRedirectInject: nativeForkAndSpecialize called, uid=` 的 log（任何可以讀 log 的東西都可以）
* 檢查 `/data/misc/storage_redirect` 下有沒有如 _0.com.example_ (user.package_name) 這樣的文件
